# 3 코드에서 나는 악취

생성일: 2022년 4월 18일 오전 1:54

3.1 기이한 이름을 바꿔보자

- 함수 선언 바꾸기
- 변수 이름 바꾸기
- 필드 이름 바꾸기

3.2 중복 코드

- 함수 추출하기
- 코드가 비슷하긴 한데 완전히 똑같지 않다면 → 문장 슬라이드 하기
- 같은 부모로부터 파생된 서브 클래스들에 코드가 중복 되어있으면 → 메서드 올리기

3.3 긴 함수

함수를 짧게 만드려면?

- 함수 추출하기 : 9.9할이 여기에 해당. 함수 본문에서 따로 묶어 빼내면 좋은 코드 블럭이 됨
- 임시 변수를 질의 함수로 바꾸기 : 임시 변수가 너무 많아졌다면? 이걸 사용.
- 매개변수 객체 만들기: 매개변수 수가 너무 많아져서 줄여야 한다면.
- 객체 통쨰로 넘기기: 상동

→ 위 방법들을 모두 적용해도 임시/매개 변수가 넘 많다면 → 함수를 명령으로 바꾸기

조건문/반복문 리팩터링

- 조건문 분해하기
- 함수 추출하기 (switch case 문에서 각 case의 본문을 함수 호출문 하나로 바꾼다)
- 조건부 로직을 다형성으로 바꾸기: 같은 조건을 기준으로 나뉘는 switch가 여러개라면
- 반복문 쪼개기 : 추출한 반복문에 성격이 다른 두가지 작업이 섞여있다면

3.4 긴 매개변수 목록

- 임시 변수를 질의 함수로 바꾸기 : 임시 변수가 너무 많아졌다면? 이걸 사용.
- 매개변수 객체 만들기: 매개변수 수가 너무 많아져서 줄여야 한다면.
- 객체 통쨰로 넘기기: 상동
- 플래그 인수 제거하기
- 여러 함수를 클래스로 묶기: 여러개의 함수가 특정 매개변수를 공통으로 사용한다면

3.5 전역 데이터

- 변수 캡슐화 하기: 접근을 통제해야함. 접근자 함수들을 클래스나 모듈에 집어넣고 그 안에서만 사용할 수 있도록 접근 범위를 최소로 줄이자
- CONST 전역데이터는 그나마 안전한 편 (?!) → 프로그램이 구동된 후에는 값이 바뀌지 않는다고 보장이 되어야함

3.6 가변 데이터

- 무분별한 데이터 수정에 따른 위험 줄이기
    - 변수 캡슐화하기
    - 변수 쪼개기
- 갱신로직은 다른 코드와 떨어뜨려 놓자
    - 문장슬라이드하기
    - 함수 추출하기
- 질의함수와 변경함수 분리하기
- 세터 제거하기
- 파생변수를 질의 함수로 바꾸기
- 유효범위가 넓어지면서 생기는 위험도를 줄이자
    - 여러 함수를 클래스로 묶기
    - 여러 함수를 변환 함수로 묶기
    - 참조를 값으로 바꾸기

3.7 뒤엉킨 변경

→ SRP가 제대로 지켜지지 않을 때 나타남

분리를 잘 해야한다 ... 그러려면

- 단계 쪼개기
- 함수 옮기기: 관련이 있는 함수끼리 모은당
- 함수 추출하기: 공통점이 있는 함수를 추출
- 클래스 추출하기

3.8 산탄총 수술

→ 뒤엉킨 변경과 비슷하면서도 정 반대임

> 코드 변경시 자잘하게 수정해야 하는 클래스가 겁나 많을때.. 를 일컫는다
> 
- 변경되는 대상 함수, 필드 옮기기 → 한 모듈에 묶자
- 여러 함수를 클래스로 묶기
- 여러함수를 변환 함수로 묶기 : 데이터 구조를 변환하거나 보강하는 함수들에 적용
- 단계 쪼개기

어설프게 분리된 로직을 함수/클래스 인라인 하기 같은 리팩터링으로 하나로 합쳐도 됨

3.9 기능 편애

때로 함수의 일부 기능만 편애할 수 있음 → 이때는 그 부분만 독립 함수로 빼낸 다음 원하는 모듈로 보내준다

- 이때 가장 많은 데이터를 포함한 모듈로 옮긴다
- 전략패턴과 방문자 패턴을 적용하면 오버라이드해야할 소량의 동작 코드를 각각의 클래스로 격리해주므로 수정하기 쉬워짐 (대신 간접 호출 상승)

3.10 데이터 뭉치

1. 필드 형태의 데이터 뭉치를 찾아서 클래스 추출 → 하나로 묶는다
2. 메서드 시그니처에 있는 데이터 뭉치 → 매개변수 객체 만들거나 객체 통쨰로 넘기기를 적용하여 매개변수 수를 줄여본다. (이 객체 필드 중 일부만 사용하는거라도 괜찮당)
3. 데이터 뭉치인지 판별 어캐함 ? → 값 하나를 삭제 해보자... 나머지 데이터만으로는 의미가 없다면 객체로 환생하길 갈망하는 데이터 뭉치임 ㅇㅇ

3.11 기본형 집착

- 기본형을 객체로 바꾸자 : 전화번호를 String → 클래스...
- 타입코드를 서브클래스로 바꾸기/ 조건부 로직을 다형성으로 바꾸기 → 차례로 적용

3.12 반복되는 switch문

모든 조건문을 다 다형성으로 바꿀필요는 없음. 반복되는 switch 문만 제거해보자.. 아니면 긴 if/else 문이라던가

3.13 반복문

반복문을 파이프라인으로 바꾸기 ← 를 적용해보자... filter/map 사용해보자

3.14 성의 없는 요소

프로그래밍 언어가 제공하는,, 기본 코드 구조를 잡는데 활용되는 요소를 그대로 냅두지 말고,,, 보내드리자..

- 함수/클래스 인라인 하기 , 계층 합치기 사용

3.15 추측성 일반화

나중에 필요할거야 → 아니,,, 당장 걸리적거리면 바로 없애자...

3.16 임시필드

특정 상황에서만 값이 설정되는 ,,, 필드라면,,

- 클래스 추출 → 함수 옮기기 (임시 필드와 관련된 코드를 모두 새 클래스에 몰아넣는다) → 그 후 조건부 로직으로 임시 필드가 유효한지 검증하는 특이 케이스 추가하기....

3.17 메시지 체인

![image](https://user-images.githubusercontent.com/24906021/163726075-f7a87e94-ce15-476b-a980-8786e3c0fa03.png)


머,, 대충 이런거라고 한다...

3.18 중개자

객체의 대표적인 기능 하나로, 외부로부터 세부사항을 숨겨주는 캡슐화와 위임을 잘 활용하여 중개자를 만들자

3.20 거대한 클래스

필드들 일부를 따로 묶는다.

같은 컴포넌트에 모아두는 것이 합당해 보이는 필드들을 선택하면됨

- 어느정도 분리가 되면...
    - 클래스 추출하기
    - 슈퍼클래스 추출하기 : 원래 클래스와 상속관계로 만드는게 낫다면
    - 타입코드를 서브클래스로 바꾸기

3.22 데이터 클래스

데이터클래스 : 데이터 필드 + 게터 + 세터 로만 구성된 클래스

- public 필드 → 레코드 캡슐화로 숨기자
- 불변필드 → 세터 제거하기

3.23 상속 포기

1. 물려받고 싶지 않을때? → 같은 계층에 서브 클래스를 하나 새로 만들고
- 메서드 내리기
- 필드 내리기

를 통해 물려받지 않을 부모 코드를 모조리 새로 만든 서브 클래스로 넘긴다

1. 서브 클래스가 부모 동작은 필요로 하지만 인터페이스는 따르고 싶지 않을때? 
- 서브 클래스를 위임으로 바꾸기
- 슈퍼 클래스를 위임으로 바꾸기

3.24 주석

주석이 필요없는 코드로 리팩터링 해보자,,,, ^^
