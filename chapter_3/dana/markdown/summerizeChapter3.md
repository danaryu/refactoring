# 코드에서 나는 악취

## 기이한 이름 (Mysterious Name)

- 코드를 명료하게 표현하는 데 가장 중요한 요소 하나는 바로 '이름'이다.
- 함수, 모듈, 변수, 클래스 등은 그 이름만 보고도 각각이 무슨 일을 하고 어떻게 사용해야 하는지 명확히 알 수 있도록 엄청나게 신경 써서 이름을 지어야 한다.
- 이름 바꾸기는 단순히 이름을 다르게 표현하는 연습이 아니다. - 마땅한 이름이 떠오르지 않는다면 설계에 더 근본적인 문제가 숨어 있을 가능성이 높다. - 혼란스러운 이름을 잘 정리하다 보면 코드가 훨씬 간결해질 때가 많다.
  > 함수 선언 바꾸기, 변수 이름 바꾸기, 필드 이름 바꾸기

## 중복 코드 (Duplicated Code)

- 똑같은 코드 구조가 여러 곳에서 반복된다면 하나로 통합하여 더 나은 프로그램을 만들 수 있다.
  > 함수 추출하기, 문장 슬라이스하기, 메서드 올리기

## 긴 함수 (Long Function)

- 짧은 함수는 간접 호출의 효과를 가진다.
  - 코드를 이해하고, 공유하고, 선택하기 쉬워진다.
- 함수 이름을 잘 지은 짧은 함수로 코드를 구성하면 이해하기 쉬운 코드를 만들 수 있다.
- 적극적으로 함수를 쪼개, 긴 함수를 짧은 함수로 만든다. - 주석을 달아야 할 만한 부분은 무조건 함수로 만든다. - 함수 본문에는 원래 주석으로 설명하려던 코드가 담기고, 함수 이름은 동작 방식이 아닌 '의도'가 드러나게 짓는다. - 함수 이름에 코드의 목적을 드러내야 한다. - '무엇을 하는지'를 코드가 잘 설명해주지 못할 수록 함수로 만드는 것이 유리하다.
  > 함수 추출하기, 임시 변수를 질의 함수로 바꾸기, 매개변수 객체 만들기, 객체 통쨰로 넘기기, 함수를 명령으로 바꾸기, 조건문 분해하기, 함수 추출하기, 조건문을 다형성으로 바꾸기, 반복문 쪼개기

## 긴 매개변수 목록 (Long Parameter List)

- 매개변수 목록이 길어지면 그 자체로 이해하기 어려울 때가 생긴다.
  > 매개변수를 질의 함수로 바꾸기, 객체 통째로 넘기기, 매개변수 객체 만들기, 플래그 인수 제거하기, 여러 함수를 클래스로 묶기

## 전역 데이터 (Global Data)

- 전역 데이터는 코드베이스 어디에서든 건드릴 수 있고, 값을 누가바꿨는지 찾아낼 메커니즘이 없기 때문에 주의가 필요하다.
  > 변수 캡슐화하기

## 가변 데이터 (Mutual Data)

> 변수 캡슐화하기, 변수 쪼개기, 문장 슬라이드하기, 함수 추출하기, 질의 함수와 변경 함수 분리하기, 세터 제거하기, 파생 변수를 질의 함수로 바꾸기, 여러 함수를 클래스로 묶기, 여러 함수를 변환 함수로 묶기, 참조를 값으로 바꾸기

## 뒤엉킨 변형 (Divergent Change)

- 단일 책임 원칙(SRP)이 제대로 지켜지지 않을 때 나타난다. - 하나의 모듈이 서로 다른 이유들로 인해 여러가지 방식으로 변경되는 일이 많을 때 발생한다.
  > 단계 쪼개기, 함수 옮기기, 함수 추출하기, 클래스 추출하기

## 산탄총 수술 (Shotgun Surgery)

- 코드를 변경할 때마다 자잘하게 수행해야하는 클래스가 많을 때 풍긴다. - 변경할 부분이 코드 전반에 퍼져 있다면 찾기도 어렵고 꼭 수정해야할 곳을 지나치기 쉽다.
  > 함수 옮기기, 필드 옮기기, 여러 함수를 클래스로 묶기, 여러 함수를 변환 함수로 묶기, 단계 쪼개기, 함수 인라인하기, 클래스 인라인하기

## 기능 편애 (Feature Envy)

- 어떤 함수가 자기가 속한 모듈의 함수나 데이터보다 다른 모듈의 함수나 데이터와 상호작용 할 일이 많을 때 풍긴다.
  > 함수 옮기기, 함수 추출하기
  >
  > > 디자인 패턴 : 전략 패턴, 방문자 패턴

## 데이터 뭉치 (Data Clumps)

- 데이터 항목 서너 개가 여러 곳에서 항상 함께 뭉쳐다니는 경우
- 데이터 뭉치인지 판별하려면 값 하나를 삭제해본다.
  - 나머지 데이터만으로는 의미가 없다면..? 객체로 환상하길 갈망하는 데이터뭉치이다... ^^
- 기능 편애를 없애는 과정에서 새로운 클래스를 만들었다면, 이어서 그 클래스로 옮기면 좋을 동작이 없는지 살펴본다.
  > 클래스 추출하기, 매기변수 객체 만들기, 객체 통째로 넘기기

## 기본형 집착 (Primitive Obsession)

- 화폐, 좌표, 구간과 같이 문제 해결에 필요한 기초 타입을 정의하기 어려워하는 경우
- 문자열만을 사용해 변수를 표현하는 경우
  > 기본형을 객체로 바꾸기, 타입 코드를 서브클래스로 바꾸기, 조건부 로직을 다형성으로 바꾸기, 클래스 추출하기, 매개변수 객체 만들기

## 반복되는 switch문 (Repeated Swithes)

- 조건절을 하나 추가할 때마다, 그 아래 중복된 switch문들도 모두 찾아서 함께 수정해야 한다.
  > 조건부 로직을 다형성으로 바꾸기

## 반복문 (Loops)

- 단순 반복문이 반복되는 경우 코드에서 각 원소들이 어떻게 처리되는지 파악하기 어렵다. - 필터나 맵같은 파이프라인 연산을 사용하여 코드에서 각 원소들이 어떻게 처리되는지 쉽게 파악할 수 있도록 한다.
  > 반복문을 파이프라인으로 바꾸기

## 성의 없는 요소 (Lazy Element)

- 본문 코드를 그대로 쓰는 것과 진배없는 함수, 실질적으로 메소드가 하나뿐인 클래스
  > 함수 인라인하기, 클래스 인라인하기, 계층 합치기

## 추측성 일반화 (Speculative Generality)

- '나중에 필요할 거야'라는 생각으로 당장은 필요없는 후킹 포인트와 특이 케이스 처리 로직을 작성해둔 코드에서 풍긴다.
  > 계층 합치기, 함수 인라인하기, 클래스 인라인하기, 함수 선언 바꾸기, 죽은 코드 제거하기

## 임시 필드 (Temporary Field)

- 특정 상황에서만 값이 설정되는 필드를 가진 클래스 (임시 필드) - 쓰이지 않는 필드가 존재하는 이유를 찾기 어렵다.
  > 클래스 추출하기, 함수 옮기기, 특이 케이스 추가하기

## 메시지 체인 (Message Chains)

- 다른 객체를 요청하는 작업이 연쇄적으로 이어지는 코드 - 클라이언트가 한 객체를 통해 다른 객체를 얻은 뒤, 방금 얻은 객체에 또 다른 객체를 요청하는 식 - 클라이언트가 객체 네비게이션 구조에 종속됐음을 의미 - 네비게이션 중간 단계를 수정하면 클라이언트 코드도 수정해야 한다.
  > 위임 숨기기, 함수 추출하기, 함수 옮기기

## 중개자 (Middle Man)

- 클래스가 제공하는 메소드 중 절반이 다른 클래스에 구현을 위임하는 경우
- 지나친 위임
  > 중개자 제거하기, 함수 인라인하기

## 내부자 거래 (Insider Trading)

- 모듈 사이의 데이터 거래가 많아 결합도가 높아진 경우
  > 함수 옮기기, 필드 옮기기, 위임 숨기기, 서브클래스를 위임으로 바꾸기, 슈퍼클래스를 위임으로 바꾸기

## 거대한 클래스 (Large Class)

- 한 클래스가 너무 많은 일을 하려다 보면 필드 수가 상당히 늘어난다.
  - 필드가 너무 많으면 중복코드가 생기기 쉽다.
- 코드량이 너무 많은 클래스인 경우
  > 클래스 추출하기, 슈퍼클래스 추출하기, 타입 코드를 서브클래스로 바꾸기

## 서로 다른 인터페이스의 대안 클래스들 (Alternative Classes with Different Interfaces)

- 클래스를 다른 클래스로 교체할 수 있는 경우(대안 클래스)이나, 각자 다른 인터페이스를 가지고 있는 경우
  > 함수 선언 바꾸기, 함수 옮기기, 슈퍼클래스 추출하기

## 데이터 클래스 (Data Class)

- 데이터 필드와 Getter/Setter 메소드로만 구성된 클래스
- 데이터 저장 용도로 쓰이다 보니, 다른 클래스가 너무 깊이까지 함부로 다룰 때가 많다.
  > 레코드 캡슐화하기, 세터 제거하기, 함수 옮기기, 함수 추출하기, 단계 쪼개기

## 상속 포기 (Refused Bequest)

- 부모클래스의 메소드와 데이터를 모두 상속받고 싶지 않은 경우
- 서브클래스가 부모클래스의 동작을 필요로하지만, 인터페이스는 따르고 싶지 않을 경우
  > 메소드 내리기, 필드 내리기, 서브클래스를 위임으로 바꾸기, 슈퍼클래스를 위임으로 바꾸기

## 주석 (Comments)

- 주석이 장황하게 달린 원인은 코드를 잘못 작성했기 때문인 경우가 많다.
- 주석을 남겨야겠다는 생각이 들면, 가장 먼저 주석이 필요 없는 코드로 리팩터링해본다.
  > 함수 추출하기, 함수 선언 바꾸기, 어서션 추가하기
