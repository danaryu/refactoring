# 챕터 내용 정리

## 4장 - 테스트 구축하기

> 리팩터링을 제대로 하려면 불가피하게 저지르는 실수를 잡아주는 견고한 테스트 스위트(test suite)가 뒷받침돼야 한다.

### 4.1 자가 테스트 코드의 가치

- 프로그래머는 대부분의 시간을 디버깅에 사용 ㅠㅠ
- 테스트를 몇 분 간격으로 자주 수행하므로, 버그가 발생한 지점을 찾기 쉬워짐
    - 회귀 버그(Regression bug) : 잘 작동하던 기능에서 문제가 생기는 현상
- 구현보다 인터페이스에 집중하게 됨
- 코딩이 완료되는 시점을 정확히 판단할 수 있음 (테스트 통과하면 끝!)

### 4.3 첫 번째 테스트

> 실패해야 할 상황에서는 반드시 실패하게 만들자.

> 자주 테스트하라. 작성 중인 코드는 최소한 몇 분 간격으로 테스트하고, 적어도 하루에 한 번은 전체 테스트를 돌려보자.

### 4.4 테스트 추가하기

> 명심하자! 테스트는 위험 요인을 중심으로 작성해야 한다!
> 테스트의 목적은 어디까지나 현재 혹은 향후에 발생하는 버그를 찾는 데 있다.

> 완벽하게 만드느라 테스트를 수행하지 못하느니, 불완전한 테스트라도 작성해 실행하는 게 낫다.

- 테스트를 편하게 추가하는 방법
    - 아무 값이나 설정해서 일단 테스트를 돌린 후 실제 값으로 대체하기
    - 오류를 일부러 심었다가 되돌리기
    
### 4.5 픽스처 수정하기

- 실무에서는 사용자가 값을 변경하며 픽스처의 내용도 수정되는 경우가 흔하므로 픽스처를 수정하는 테스트도 진행

### 4.6 경계 조건 검사하기

- 꽃길(Happy Path) 상황에 집중하지 않고 경계 지점도 테스트해야함
- 실패와 에러
    - 실패(failure) : 검증 단계에서 실제 값이 예상 범위를 벗어남
    - 에러(error) : 검증보다 앞선 과정에서 발생한 예외 상황
- 에러 대응 방안
    - 에러 핸들링 코드 추가
    - 의미있는 오류 메시지 출력
    - 그냥 남겨둠 (입력 객체가 신뢰할 수 있는 곳에서 만들어질 경우)
- 리팩터링하기 전이라면 경계 조건은 검사하지 않아도 됨
    - 리팩터링 : 겉보기 동작에 영향을 주지 않아야 함
    - 경계 조건에서의 오류는 겉보기 동작이 아니므로
    
### 4.7 끝나지 않은 여정

> 버그 리포트를 받으면 가장 먼저 그 버그를 드러내는 단위 테스트부터 작성하자. 