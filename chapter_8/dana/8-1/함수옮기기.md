# 함수 옮기기
## 배경
- 좋은 소프트웨어 설계의 핵심은 **모듈성**
  - 모듈화가 얼마나 잘 되어 있느냐?
    - 모듈성을 가진 프로그램은 작은 코어 부분만 이해해도 해당 프로그램을 수정할 수 있다.
  - 모듈성을 높이려면?
    - 연관된 요소들은 함께 묶는다.
    - 요소 사이의 연결 관계를 쉽게 찾고 이해하도록 한다.
- 객체지향 프로그래밍의 핵심 **모듈화 컨텍스트**는 클래스
  - 모든 함수는 어떤 컨텍스트 안에 존재한다. 
  - 함수를 다른 함수에 중첩 → 공통 컨텍스트 생성
  - 프로그래밍 언어들은 각기 다른 모듈화 수단을 통해 함수가 살아숨쉬도록 만든다. 
- 어떤 함수가 모듈 A의 요소들보다 다른 모듈 B의 요소를 더 많이 참조할 때 → 함수를 A에서 B로 옮긴다.
- 호출자들의 현재 위치나 다음 업데이트 때 바뀌리라 예상되는 위치에 따라서도 함수를 옮긴다.
- 다른 클래스로 옮기면 사용하기 더 편한 메소드도 있다.

## 절차 
1. 선택한 함수가 현재 컨텍스트에서 사용 중인 모든 프로그램 요소를 살펴보고, 함께 옮길 요소가 있는지 찾기
   - 호출되는 함수 중 함께 옮길 게 있다면 대체로 그 함수를 먼저 옮기자.
     - 얽혀있는 함수가 여러개라면? 영향도가 적은 함수부터 옮기자.
   - 하위 함수들의 호출자가 고수준 함수 하나뿐일 때
     - 먼저 하위 함수들을 고수준 함수에 인라인한다.
     - 옮긴 위치에서 개별 함수들로 다시 추출한다.
2. 선택한 함수가 다형 메서드인지 확인
   - 슈퍼클래스나 서브클래스에도 선언되어 있는지까지 고려한다.
3. 선택한 함수를 타겟 컨텍스트로 복사한다. 타겟 함수가 새로운 터전에 잘 자리 잡도록 다듬는다.
    - 함수 본문에서 소스 컨텍스트의 요소를 사용한다면, 매개변수로 넘기거나 소스 컨텍스트 자체를 참조로 넘긴다.
    - 이름 변경이 필요하면 변경한다.
4. 정적 분석 수행
5. 소스 컨텍스트에서 타깃 함수를 참조할 방법을 찾아 반영
6. 소스 함수를 타깃 함수의 위임 함수가 되도록 수정
7. 테스트
8. 소스 함수를 인라인할지 고민
    - 소스 함수는 위임 함수로 남겨둘 수 있지만, 소스 함수를 호출하는 곳에서 타깃 함수 직접 호출이 가능하면 없애는 편이 낫다.

## 예시
[함수옮기기 예시](../8-1/example.js)<br>
[함수옮기기 예시2](../8-2/example.js)<br>